# Configuración Apache para OSAC Knowledge Bot
# Coloca este archivo en: /etc/apache2/sites-available/osac-knowledge-bot.conf

<VirtualHost *:80>
    ServerName osac-knowledge-bot.perfumesclub-helping.com
    ServerAlias 82.223.20.111
    
    # Logs específicos para esta aplicación
    ErrorLog ${APACHE_LOG_DIR}/osac-knowledge-bot-error.log
    CustomLog ${APACHE_LOG_DIR}/osac-knowledge-bot-access.log combined
    
    # Activar proxy
    ProxyPreserveHost On
    
    # Frontend (React) - Servir archivos estáticos compilados o dev server
    ProxyPass / http://localhost:3001/
    ProxyPassReverse / http://localhost:3001/
    
    # Backend API
    ProxyPass /api http://localhost:8001/api
    ProxyPassReverse /api http://localhost:8001/api
    
    # Headers para CORS
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
    
    # Para peticiones OPTIONS (preflight)
    <LocationMatch "^/api">
        RewriteEngine On
        RewriteCond %{REQUEST_METHOD} OPTIONS
        RewriteRule ^(.*)$ $1 [R=200,L]
    </LocationMatch>
    
    # Timeout para requests largos (chat con IA)
    ProxyTimeout 300
    Timeout 300
</VirtualHost>

